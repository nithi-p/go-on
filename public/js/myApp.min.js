var app=angular.module("myApp",["firebase"]);app.controller("myCtrl",["$scope","$firebaseObject","$firebaseArray",function(a,b,c){var d=firebase.database().ref().child("currentNum"),e=b(d);e.$bindTo(a,"currentNum");var f=b(d);f.$bindTo(a,"box");var g=firebase.database().ref().child("box"),h=c(g);!function(){var b=Box2D.Common.Math.b2Vec2,d=(Box2D.Collision.b2AABB,Box2D.Dynamics.b2BodyDef),e=Box2D.Dynamics.b2Body,f=Box2D.Dynamics.b2FixtureDef,i=(Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2World),k=(Box2D.Collision.Shapes.b2MassData,Box2D.Collision.Shapes.b2PolygonShape),l=Box2D.Collision.Shapes.b2CircleShape,m=Box2D.Dynamics.b2DebugDraw;Box2D.Dynamics.Joints.b2RevoluteJointDef,Box2D.Dynamics.Joints.b2MouseJointDef;window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a,b){window.setTimeout(a,1e3/60)}}();var p,q,r,s,t,u={},v=!1,w={start:function(a){this.defaultProperties(),this.canvas(a),y.create.world(),y.create.defaultFixture(),this.surroundings.leftWall(),this.surroundings.rightWall(),this.surroundings.ground(),this.callbacks(),setTimeout(function(){location.reload()},1e6),function a(){z.step(),z.update(),v&&s.DrawDebugData(),z.draw(),requestAnimFrame(a)}()},defaultProperties:function(){p=55},canvas:function(a){q=document.getElementById(a),r=q.getContext("2d"),r.canvas.width=window.innerWidth,r.canvas.height=window.innerHeight},surroundings:{rightWall:function(){x.box({x:q.width/p+1,y:q.height/p-q.height/p*.5,height:q.height/p,width:2,isStatic:!0})},ground:function(){x.box({x:q.width/p-q.width/p*.5,y:q.height/p+.05,height:.1,width:q.width/p,isStatic:!0})},leftWall:function(){x.box({x:-1,y:q.height/p-q.height/p*.5,height:q.height/p,width:2,isStatic:!0})}},callbacks:function(){h.$watch(function(a){var b={username:h[h.length-1].firstname,longtext:h[h.length-1].lastname,radius:2};x.circle(b),setTimeout(function(){x.bloodDrop(b)},50)},!0),q.addEventListener("click",function(){var a="",b="ABO";a+=b.charAt(Math.floor(Math.random()*b.length));var c=Math.random()<.75?a:"AB",d={username:c,longtext:""};x.bloodGroup(d)},!1),a.$watch("currentNum",function(){var a={radius:2};x.random(a),setTimeout(function(){x.random(a)},250),setTimeout(function(){x.random(a)},600)},!0)}},x={random:function(a){if(a=a||{},Math.random()<.25){var b="",c="ABO";b+=c.charAt(Math.floor(Math.random()*c.length));var d=Math.random()<.75?b:"AB";a.username=d,a.longtext="",this.bloodGroup(a)}else this.bloodDrop(a)},circle:function(a){a.radius=.8+.2*Math.random(),a.x=q.width/p*.5+.1*Math.random();var b=new C(a);u[b.id]=b,y.addToWorld(b)},bloodGroup:function(a){a.radius=.4+.2*Math.random(),a.x=q.width/p*.5+.1*Math.random();var b=new C(a);u[b.id]=b,y.addToWorld(b)},bloodDrop:function(a){a.radius=.25+.1*Math.random(),a.x=q.width/p*.5+.1*Math.random();var b=new D(a);u[b.id]=b,y.addToWorld(b)},box:function(a){a.width=a.width||.5+2*Math.random(),a.height=a.height||.5+2*Math.random();var b=new E(a);u[b.id]=b,y.addToWorld(b)}},y={addToWorld:function(a){var b=this.create.bodyDef(a),c=s.CreateBody(b);a.radius?t.shape=new l(a.radius):(t.shape=new k,t.shape.SetAsBox(a.width/2,a.height/2)),c.CreateFixture(t)},create:{world:function(){if(s=new i(new b(0,30),!0),v){var a=new m;a.SetSprite(r),a.SetDrawScale(30),a.SetFillAlpha(.3),a.SetLineThickness(1),a.SetFlags(m.e_shapeBit|m.e_jointBit),s.SetDebugDraw(a)}},defaultFixture:function(){t=new f,t.density=1,t.friction=.1,t.restitution=.4},bodyDef:function(a){var b=new d;return 1==a.isStatic?b.type=e.b2_staticBody:b.type=e.b2_dynamicBody,b.position.x=a.x,b.position.y=a.y,b.userData=a.id,b.angle=a.angle,b}},get:{bodySpec:function(a){return{x:a.GetPosition().x,y:a.GetPosition().y,angle:a.GetAngle(),center:{x:a.GetWorldCenter().x,y:a.GetWorldCenter().y}}}}},z={step:function(){var a=1/60;s.Step(a,10,10),s.ClearForces()},update:function(){for(var a=s.GetBodyList();a;a=a.m_next)a.IsActive()&&"undefined"!=typeof a.GetUserData()&&null!=a.GetUserData()&&u[a.GetUserData()].update(y.get.bodySpec(a))},draw:function(){v||r.clearRect(0,0,q.width,q.height);for(var a in u)u[a].draw()}},A={randomColor:function(){var a="rgba(",b=255,c=20+Math.round(50*Math.random()),d=40+Math.round(50*Math.random()),e=b+","+c+","+d+",0.07)";return a+=e}},B=function(a){this.id=Math.round(1e6*Math.random()),this.x=a.x||23*Math.random()+1,this.y=a.y||0,this.angle=0,this.color=A.randomColor(),this.center={x:null,y:null},this.isStatic=a.isStatic||!1,this.update=function(a){this.angle=a.angle,this.center=a.center,this.x=a.x,this.y=a.y}},C=function(a){B.call(this,a),this.radius=a.radius||1,this.username=a.username,this.longtext=a.longtext,this.draw=function(){r.save(),r.translate(this.x*p,this.y*p),r.rotate(this.angle),r.translate(-this.x*p,-this.y*p),r.fillStyle=this.color,r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p,0,2*Math.PI,!0),r.closePath(),r.fill(),r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p,0,2*Math.PI,!0),r.closePath(),r.fill(),r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p,1,2*Math.PI,!0),r.closePath(),r.fill(),r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p-1,0,2*Math.PI,!0),r.closePath(),r.fill(),r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p+3,0,2*Math.PI,!0),r.closePath(),r.fill(),r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p+4,0,2*Math.PI,!0),r.closePath(),r.fill(),r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p+6,0,2*Math.PI,!0),r.closePath(),r.fill(),r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p-1,0,2*Math.PI,!0),r.closePath(),r.fill(),r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p-2,0,2*Math.PI,!0),r.closePath(),r.fill(),r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p-3,0,2*Math.PI,!0),r.closePath(),r.fill(),r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p-4,0,2*Math.PI,!0),r.closePath(),r.fill(),r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p-5,0,2*Math.PI,!0),r.closePath(),r.fill(),r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p-6,0,2*Math.PI,!0),r.closePath(),r.fill(),r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p-7,0,2*Math.PI,!0),r.closePath(),r.fill(),r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p-8,0,2*Math.PI,!0),r.closePath(),r.fill(),r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p-10,0,2*Math.PI,!0),r.closePath(),r.fill(),r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p-12,0,2*Math.PI,!0),r.closePath(),r.fill(),r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p-14,0,2*Math.PI,!0),r.closePath(),r.fill(),r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p-20,0,2*Math.PI,!0),r.closePath(),r.fill(),r.font=(this.radius*p*.3).toString()+"px Lato",r.textBaseline="middle",r.textAlign="center",r.fillStyle="white",r.fillText(this.username,this.x*p,this.y*p-7),r.font=(this.radius*p*.17).toString()+"px Lato";var a=this.longtext,b=a.split("").join(String.fromCharCode(8202));r.fillText(b,this.x*p,this.y*p+this.radius*p*.2-4),r.font=(this.radius*p*.21).toString()+"px Lato",r.restore()}};C.prototype=B;var D=function(a){B.call(this,a),this.radius=a.radius||1,this.draw=function(){r.save(),r.translate(this.x*p,this.y*p),r.rotate(this.angle),r.translate(-this.x*p,-this.y*p),r.fillStyle="rgba(255,0,0,0.05)",r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p,0,2*Math.PI,!0),r.closePath(),r.fill(),r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p-3,0,2*Math.PI,!0),r.closePath(),r.fill(),r.fillStyle="rgba(255,0,0,0.09)",r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p-9,0,2*Math.PI,!0),r.closePath(),r.fill(),r.beginPath(),r.arc(this.x*p,this.y*p,this.radius*p-12,0,2*Math.PI,!0),r.closePath(),r.fill(),r.restore()}};D.prototype=B;var E=function(a){B.call(this,a),this.width=a.width||2*Math.random()+.5,this.height=a.height||2*Math.random()+.5,this.draw=function(){r.save(),r.translate(this.x*p,this.y*p),r.rotate(this.angle),r.translate(-this.x*p,-this.y*p),r.fillStyle=this.color,r.fillRect((this.x-this.width/2)*p,(this.y-this.height/2)*p,this.width*p,this.height*p),r.restore()}};E.prototype=B,w.start("box2d-demo")}()}]);